import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy.cluster.hierarchy import dendrogram, linkage
from sklearn.cluster import AgglomerativeClustering
#Load dataset
data = pd.read_csv("Mall_Customers.csv")
X = data.iloc[:, [3, 4]].values
#Dendrogram
plt.figure()
dendrogram(linkage(X, method='ward'))
plt.title("Dendrogram")
plt.xlabel("Customers")
plt.ylabel("Euclidean Distance")
plt.show()
#Agglomerative Clustering
hc = AgglomerativeClustering(n_clusters=5, linkage='ward')
labels = hc.fit_predict(X)
#Plot clusters
colors = ['blue', 'green', 'red', 'cyan', 'magenta']
for i in range(5):
plt.scatter(X[labels == i, 0], X[labels == i, 1], s=50, label=f'Cluster {i+1}')
plt.title("Customer Clusters")
plt.xlabel("Annual Income (k$)")
plt.ylabel("Spending Score (1-100)")
plt.legend()
plt.show()
